name: Upterm SSH

on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Install Upterm
      run: |
        sudo apt update
        sudo apt install -y wget
        wget https://github.com/owenthereal/upterm/releases/download/v0.7.7/upterm_0.7.7_linux_amd64.tar.gz
        tar -xzf upterm_0.7.7_linux_amd64.tar.gz
        sudo mv upterm /usr/local/bin/
    - name: Start Upterm Session
      run: |
        ./upterm host -- bash > session.txt 2>&1 &
        sleep 10
        cat session.txt
    - name: Keep alive
      run: timeout 6h tail -f /dev/null
